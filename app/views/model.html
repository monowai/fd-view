<!--
  ~
  ~  Copyright (c) 2012-2016 "FlockData LLC"
  ~
  ~  This file is part of FlockData.
  ~
  ~  FlockData is free software: you can redistribute it and/or modify
  ~  it under the terms of the GNU General Public License as published by
  ~  the Free Software Foundation, either version 3 of the License, or
  ~  (at your option) any later version.
  ~
  ~  FlockData is distributed in the hope that it will be useful,
  ~  but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~  GNU General Public License for more details.
  ~
  ~  You should have received a copy of the GNU General Public License
  ~  along with FlockData.  If not, see <http://www.gnu.org/licenses/>.
  -->


<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    Model
    <small>Content that describe the data you want to import</small>
  </h1>
  <ol class="breadcrumb">
    <li><a ui-sref="welcome"><i class="fa fa-home"></i> Home</a></li>
    <li class="active">Model</li>
  </ol>
</section>

<!-- Main content -->
<section class="content">
  <div class="row">
    <div class="col-md-12">
      <div class="box">
        <div class="box-header">
          <h3 class="box-title">Manage Content Models - {{profile.companyName}}</h3>

          <div class="box-tools">
            <div class="input-group input-group-sm box-filter">
              <select class="form-control" id="fortress" ng-model="fortress" ng-options="f.name as f.name for f in fortresses">
                <option value="" selected>Data Provider</option>
              </select>
              <!--<div class="input-group-btn">-->
                <!--<button class="btn" ng-click="createFortress()" uib-tooltip="New Data Provider"><i class="fa fa-lg fa-plus"></i></button>-->
              <!--</div>-->
            </div>
          </div>
        </div>
        <!-- /.box-header -->
        <div class="box-body table-responsive no-padding">
          <div class="box-controls">
            <!--<button type="button" class="btn btn-default btn-sm" uib-tooltip="Select all" ng-click="selectAll()"><i class="fa" ng-class="allSelected ? 'fa-check-square-o' : 'fa-square-o'"></i></button>-->
            <button type="button" class="btn btn-sm btn-primary" uib-tooltip="Create new" ng-click="createProfile()"><i class="fa fa-plus"></i></button>
            <label for="file" class="btn btn-default btn-sm file-box-input" uib-tooltip="Open from file">
              <input type="file" id="file" class="box-file" accept=".json" onchange="angular.element(this).scope().openFile(this)"><i class="fa fa-upload"></i></label>
            <button type="button" class="btn btn-default btn-sm" uib-tooltip="Save to file" ng-click="downloadModel(selected)"><i class="fa fa-download"></i></button>
            <button type="button" class="btn btn-default btn-sm" uib-tooltip="Delete selected" ng-click="deleteModel(selected)"><i class="fa fa-trash-o"></i></button>
          </div>
          <table class="table table-hover">
            <tbody><tr>
              <td>
                <input type="checkbox" uib-tooltip="Select all" ng-checked="allSelected" ng-click="selectAll()"/>
              </td>
              <th>Data Provider</th>
              <th>Type</th>
              <th>Description</th>
              <th>Action</th>
            </tr>
            <tr ng-repeat="cp in cplist | filter:fortress.toString()" ng-click="selectModel(cp.key)">
              <td>
                <input type="checkbox" value="{{cp.key}}" ng-checked="selected.indexOf(cp.key)>-1"/>
              </td>
              <td>{{cp.fortress}}</td>
              <td>{{cp.documentType}}</td>
              <td>{{cp.name}}</td>
              <td>
                <div class="tools">
                  <button type="button" class="btn btn-box-tool" uib-tooltip="Edit" ng-click="editModel(cp)"><i class="fa fa-lg fa-edit"></i></button>
                  <button type="button" class="btn btn-box-tool" uib-tooltip="Save to disk" ng-click="downloadModel([cp.key])"><i class="fa fa-lg fa-download"></i></button>
                  <button type="button" class="btn btn-box-tool" uib-tooltip="Delete" ng-click="deleteModel([cp.key])"><i class="fa fa-lg fa-trash-o"></i></button>
                </div>
              </td>
            </tr>
            </tbody></table>
        </div>
        <!-- /.box-body -->
        <div class="box-footer">

        </div>
      </div>
    </div>
  </div>
</section>

<script type="text/ng-template" id="create-profile.html">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()">
      <span aria-hidden="true">&times;</span></button>
    <h4 class="modal-title">Create Content Profile Container</h4>
  </div>
  <form role="form" name="contentForm" ng-submit="createEmpty(contentForm.$valid, new)" novalidate>
    <div class="modal-body">
      <div class="row">
        <div class="col-md-12">
          <div class="form-group">
            <label for="description"> Description</label>
            <input type="text" id="description" name="description" class="form-control" ng-model="new.name" ng-required="true" />
          </div>
          <div class="form-group" ng-show="new.tagModel">
            <label for="code"> Code</label>
            <input type="text" id="code" name="code" class="form-control" ng-model="new.code" ng-required="new.tagModel"/>
          </div>
        </div>
        <div class="col-md-8">
          <div class="form-group">
            <div class="checkbox">
              <label>
                <input type="checkbox" ng-model="new.tagModel"> Tags only?
              </label>
            </div>
          </div>
          <div class="form-group">
            <label for="new-fortress"> Data Provider</label>
            <div class="input-group">
              <select class="form-control" id="new-fortress"  ng-model="new.fortress.name" ng-options="f.name as f.name for f in fortresses" ng-change="selectFortress(new.fortress.name)" ng-disabled="new.tagModel" ng-required="!new.tagModel"></select>
              <div class="input-group-btn">
                <button type="button" class="btn btn-primary" ng-click="createFortress()"  ng-disabled="new.tagModel"><i class="fa fa-plus"></i></button>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label for="new-type"> Document Type</label>
              <div class="input-group">
                <select class="form-control" id="new-type" ng-model="new.documentType.name" ng-options="d.name as d.name for d in documents" ng-disabled="new.tagModel" ng-required="!new.tagModel"></select>
                <div class="input-group-btn">
                  <button type="button" class="btn btn-primary" ng-click="createType(new.fortress)" ng-disabled="new.tagModel"><i class="fa fa-plus"></i></button>
                </div>
              </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-default pull-left" ng-click="cancel()">Cancel</button>
      <button type="submit" class="btn btn-primary" ng-disabled="contentForm.$invalid"><i class="fa fa-bolt"></i>&nbsp; Create</button>
    </div>
  </form>
</script>

<script type="text/ng-template" id="create-fortress-modal.html">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="close()">
      <span aria-hidden="true">&times;</span></button>
    <h4 class="modal-title">Configure New Data Provider</h4>
  </div>
  <div class="modal-body">
    <form role="form" class="form-horizontal">
      <div class="row">
        <div class="col-md-8">
          <div class="form-group">
            <label for="name" class="col-sm-2 control-label">Name</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id="name" placeholder="DP name" ng-model="name" autofocus>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <!-- <div class="form-group"> -->
            <select name="timezone" id="timezone" class="form-control" ng-model="timezone" ng-options="tz as tz for tz in timezones" placeholder="Timezone"></select>
          <!-- </div> -->
        </div>
      </div>
      <div class="form-group">
        <div class="col-sm-4 checkbox">
          <label><input type="checkbox" ng-model="searchable"> Searchable Content?</label>
        </div>
        <div class="col-sm-4 checkbox">
          <label><input type="checkbox" ng-model="versionable"> Track Versions?</label>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-primary" ng-click="save()"><i class="fa fa-floppy-o"></i>&nbsp; Save</button>
  </div>
</script>

<script type="text/ng-template" id="create-type-modal.html">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="close()">
      <span aria-hidden="true">&times;</span></button>
    <h4 class="modal-title">Create Data Type</h4>
  </div>
  <div class="modal-body">
    <form role="form" class="form-horizontal">
      <div class="row">
        <div class="col-md-12">
          <div class="form-group">
            <label for="name" class="col-sm-2 control-label">Name</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" placeholder="Data type name" ng-model="name" autofocus>
            </div>
          </div>
        </div>
      </div>
      <!-- ** requires end point **
      <div class="form-group">
        <div class="col-sm-4 checkbox">
          <label><input type="checkbox" ng-model="searchable"> Searchable</label>
        </div>
        <div class="col-sm-8 checkbox">
          <label><input type="checkbox" ng-model="versionable"> Versionable Content</label>
        </div>
      </div> -->
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-primary" ng-click="save(name)"><i class="fa fa-floppy-o"></i>&nbsp; Save</button>
  </div>
</script>

<script type="text/ng-template" id="error-modal.html">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="ok()">
      <span aria-hidden="true">&times;</span></button>
    <h4 class="modal-title">{{missing}} missing.</h4>
  </div>
  <div class="modal-body">
    <p>Please choose a {{missing}}&hellip;</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-primary" ng-click="ok()">Ok</button>
  </div>
</script>
